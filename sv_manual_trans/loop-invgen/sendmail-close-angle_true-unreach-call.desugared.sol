  buf <= buflim && in <= buf + 1
