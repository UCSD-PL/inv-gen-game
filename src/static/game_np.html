<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- third party libraries -->
  <script src="jquery-1.12.0.min.js"></script>
  <script src="jquery.jsonrpcclient.js"></script>
  <script src="jquery.color-2.1.2.min.js"></script>
  <script src="jquery-ui-1.11.4/jquery-ui.js"></script>
  <script src="esprima.js"></script>
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="bootstrap-theme.min.css">
  <script src="bootstrap.min.js"></script>
  <script src="notify.js"></script>
  <script src="ion.sound-3.0.7/ion.sound.min.js"></script>

  <!-- our code -->
  <link rel="stylesheet" href="inv.css">
  <link rel="stylesheet" href="arrow.css">
  <script src="build/ts/container.js"></script>
  <script src="build/ts/stickyWindow.js"></script>
  <script src="build/ts/progressWindow.js"></script>
  <script src="build/ts/scoreWindow.js"></script>
  <script src="build/ts/logic.js"></script>
  <script src="build/ts/traceWindow.js"></script>
  <script src="build/ts/gameLogic.js"></script>
  <script src="build/ts/level.js"></script>
  <script src="build/ts/eval.js"></script>
  <script src="build/ts/pp.js"></script>
  <script src="build/ts/util.js"></script>
  <script src="build/ts/powerups.js"></script>
  <script src="build/ts/rpc.js"></script>

  <script>
    var gameId;
    var playerId;
    var currentGen = 0;
    var values = { expressions: {}, players: [] };
    var playerLvl = null;
    var time = 2000;
    var numReqExpr = 4;
    var numExpFound = 0;
    var numFound = 0;
    var doneScript = false;
    var esprimaMapping = {};
    var bonus = 10;
    var points = 0;


    var curLvl;
    var curLvlId;
    var curLvlSet;
    var curL = null;
    var lvls = null;
    var tracesW = null, progW = null, scoreW = null;
    var gameLogic = null;
    var stepTimeout = 5000;
    var curScript = null;
    var dynamicLvlOrder = true;
    var numLvlPassed = 0;

    disableBackspaceNav();

    function loadTrace(traceId) {
      PrepopulatedDynamicLevel.load(curLvlSet, traceId, function(lvl) {
        curLvlId = traceId
        gameLogic.loadLvl(lvl)
      })
    }

    function loadNextTrace() {
      PrepopulatedDynamicLevel.loadNext(function(res) {
        if (res === null)
          doneScreen(true)
        else {
          curLvlSet = res[0];
          let lvl = res[1];
          playerLvl = lvl;
          curLvlId = lvl.id;
          console.log("Just loaded " + curLvlSet + "." + curLvlId);
          if (lvl.hint === null)
            $("#hint-row").html("");
          else
            // $("#hint-row").html("<p class='lead'><b>" + lvl.hint + "</b></p>");
          console.log("Sorin " + lvl.hint);
          gameLogic.loadLvl(lvl);
        }
      })
    }

    function nextLvl() {
      if (dynamicLvlOrder)
        loadNextTrace()
      else
        loadLvl(curLvl + 1);
    }

    function loadLvl(lvl) {
      if (lvl == lvls.length) {
        curLvl = lvl;
        doneScreen(true);
      } else {
        curLvl = lvl;

        if (typeof(lvls[lvl]) == "string") {
          loadTrace(lvls[curLvl]);
        } else {
          gameLogic.loadLvl(lvls[curLvl])
        }
      }
    }

    function loadLvlSet(lvlset) {
      curLvlSet = lvlset;
      res = rpc.call('App.listData', [lvlset], function(res) {
        lvls = res;
        curLvl = -1;
        nextLvl();
      }, log)
    }

    function synchronize() {
      var localState = getLocalState();
      var serverState = getServerState(function(state) {
        if (!equalStates(state, localState)) {
          updateStates(state, localState);
        }
      });
    }

    function equalStates(sState, lState) {
      if (sState.length !== 2 || lState.length !== 2) {
        return false;
      }
      return (sState[0] === lState[0]) && equalValues(sState[1], lState[1]);
    }

    function equalValues(sVal, lVal) {
      return equalPlayers(sVal.players, lVal.players);
    }

    function equalPlayers(p1, p2) {
      if (p1 === undefined || p2 === undefined) {
        return false;
        }
      if(!p1.length || !p2.length) {
        return false;
      }
      if (p1.length !== p2.length) {
        return false;
      }
      for (var i = p1.length; i--;) {
        if ((p1[i].id !== p2[i].id)
        || (p1[i].score !== p2[i].score)
        || (p1[i].level !== p2[i].level)) {
          return false;
        }
      }
      return true;
    }

    function parseValue(val) {
      var pVal = null;
      if (typeof val === "object") {
        pVal = val;
      }
      else {
        pVal = JSON.parse(val);
      }
      return pVal;
    }

    function getScore() {
      var sessionScore = sessionStorage.getItem("score");
      if (scoreW) {
        if (sessionScore && (sessionStorage.getItem("gameId") == gameId)) {
          if (scoreW.score >= sessionScore) {
            return scoreW.score;
          }
          else {
            return sessionScore;
          }
        }
        else {
          return scoreW.score;
        }
      }
      else if (sessionScore) {
        return sessionScore;
      }
      else {
        return 0;
      }
    }

    function getLocalState() {
      var lvlId = null;
      
      if (playerLvl) {
        lvlId = playerLvl.id;
      }

      if (progW && lvlId) {
        values.expressions[lvlId] = progW.invMap;
        for (var inv in values.expressions[lvlId]) {
          progW.addInvariant(inv, esprima.parse(inv));
        }
      }

      if (playerId && playerLvl) {
        var currentPlayer = { id: playerId, score: 0, level: playerLvl };

        currentPlayer.score = getScore();

        gameLogic.score = currentPlayer.score;
        scoreW.score = currentPlayer.score;
        $("#scoreNum").html(currentPlayer.score);

        if(values.players === undefined) {
          values.players = [];
        }

        if (isNewPlayer(currentPlayer, values.players)) {
          values.players.push(currentPlayer);
        }
        else {
          updateScore(currentPlayer);
        }
      }
      return [currentGen, values];
    }

    function getServerState(cb) {
      if (gameId) {
        res = rpc.call('App.get', [gameId], function(res) {
          var currentGenS = res[0];
          var valuesS = parseValue(res[1]);
          cb([currentGenS, valuesS]);
        }, log);
      }
    }

    function updateScore(curPlayer) {
      for (var player = 0, len = values.players.length; player < len; player++) {
        if (values.players[player].id === curPlayer.id) {
          values.players[player].score = curPlayer.score;
          return;
        }
      }
    }

    function updateStates(serverState, localState) {
      updateLocalState(serverState, localState);

      res = rpc.call('App.set', [gameId, values, currentGen], function(res) {
        currentGen = res[0];
        values = parseValue(res[1]);
        updateLocalState([currentGen, values], localState);
      }, log);
    }

    function updateLocalState(serverState, localState) {
      var serverGen = serverState[0];
      var serverVal = serverState[1];
      var localGen = localState[0];
      var localVal = localState[1];

      currentGen = serverGen > localGen ? serverGen : localGen;
      mergeValues(serverVal, localVal);
      updateMapping();
      points = 0;
      findWeakInvariants();
    }

    function updateMapping() {
      if (playerLvl) {
        var currentLvlExpressions = values.expressions[playerLvl.id];
        allExp = []
        
        for (var exp in currentLvlExpressions) {
          allExp.push(exp);
        }

        var mappedExp = allExp.map(esprima.parse);
        var mappedExp1 = mappedExp.map(esprimaToStr);

        for (var i = 0; i < mappedExp1.length; i++) {
          esprimaMapping[mappedExp1[i]] = allExp[i];
        }
      }
    }

    function findWeakInvariants() {
      if (playerLvl) {
        var currentLvlExpressions = values.expressions[playerLvl.id];
        for (var exp in currentLvlExpressions) {
          var curExp = esprima.parse(exp);
          var otherExps = [];
          
          for (var exps in currentLvlExpressions) {
            if (exp !== exps) {
              otherExps.push(exps);
            }
          }

          var otherExp = otherExps.map(esprima.parse);

          impliedPairs([curExp], otherExp, function(x) {
            if (x !== null && x.length > 0) {
              for (var i = 0; i < x.length; i++) {
                var exp1 = esprimaToStr(x[i][0]);
                var exp2 = esprimaToStr(x[i][1]);
                // console.log(exp1 + " ==> " + exp2);
                crush(exp2);
              }
              addBonus();
            }
            // else {
            //   points = 0;
            // }
          });
        }
      }
    }

    function addBonus() {
      if (points > 0) {
        var score = bonus * points;
        scoreW.add(score);
        gameLogic.score = (parseInt(gameLogic.score.toString()) + parseInt(score.toString()));
        var sessionScore = sessionStorage.getItem("score");
        sessionStorage.setItem("score", (parseInt(sessionScore.toString()) + parseInt(score.toString())));
        points = 0;
      }
    }

    function crush(expression) {
      var expressions = values.expressions[playerLvl.id];
      var exp = expressions && esprimaMapping && esprimaMapping[expression] ? expressions[esprimaMapping[expression]] : null;
      var expId = exp && exp.id ? exp.id : null;
      if (expId) {
        var elem = $("#" + expId);
        if (!elem.hasClass("implied")) {
          points = (parseInt(points.toString()) + 1);
          elem.slideUp();
          elem.addClass("implied");
        }
      }
    }

    function mergeValues(serverValue, localValue) {
      if(equalValues(serverValue, localValue)) {
        return;
      }

      values.players = mergePlayers(serverValue.players, localValue.players);      
      values.expressions = mergeExpressions(serverValue.expressions, localValue.expressions);

      scoreW.updatePlayers(values.players);

      if (playerLvl) {
        var lvlId = playerLvl.id;
        for (var inv in values.expressions[lvlId]) {
            progW.addInvariant(inv, esprima.parse(inv));
        }
      }
    }

    function mergePlayers(serverPlayers, localPlayers) {
      var players = serverPlayers ? serverPlayers : localPlayers;

      for (var player = 0; player < localPlayers.length; player++) {
        if (isNewPlayer(localPlayers[player], players)) {
          players.push(localPlayers[player]);
        }
        else {
          var curPlayer = localPlayers[player];
          for (var sPlayer = 0, len = players.length; sPlayer < len; sPlayer++) {
            if (players[sPlayer].id === curPlayer.id && players[sPlayer].score !== curPlayer.score) {
              players[sPlayer].score = curPlayer.score > players[sPlayer].score ? curPlayer.score : players[sPlayer].score;
              players[sPlayer].level = curPlayer.level > players[sPlayer].level ? curPlayer.level : players[sPlayer].level;
              break;
            }
          }
        }
      }

      if (players && localPlayers &&
          players.length > localPlayers.length) {
        notifyNewPlayer();
      }

      return players;
    }

    function notifyNewPlayer() {
      $("#scoreboard-div-row").notify("New player joined!", "info");
      ion.sound.play("button_tiny");
    }
    
    function mergeExpressions(serverExpressions, localExpressions) {
      var expressions = localExpressions;
      for (var level in serverExpressions) {
        expressions[level] = $.extend({}, serverExpressions[level], localExpressions[level]);
      }      
      if (expressions[curLvlId] && Object.keys(expressions[curLvlId]).length >= numReqExpr) {
        $("#skip-to-next-lvl").show();
        $('#skip-to-next-lvl').prop("disable", false);
      }
      else {
        $("#skip-to-next-lvl").hide();
        $('#skip-to-next-lvl').prop("disable", true);
      }

      numFound = (expressions && expressions[curLvlId] && Object.keys(expressions[curLvlId])) ? Object.keys(expressions[curLvlId]).length : 0;
      
      if (numFound === 0) {
        numExpFound = 0;
      }

      if (numFound > numExpFound) {
        notifyNewExpression();
        numExpFound = numFound;
      }

      return expressions;
    }

    function notifyNewExpression() {
      $("#progWin").notify("New expression found!");
      ion.sound.play("water_droplet_3");
    }

    function isNewPlayer(currentPlayer, players) {
      if (players.length === 0) {
        return true;
      }

      playerIds = [];
      for (var player = 0, len = players.length; player < len; player++) {
        playerIds.push(players[player].id);
      }
      
      if (playerIds.indexOf(currentPlayer.id) === -1) {
        return true;
      }
      return false;
    }

    function quit() {
      var id = sessionStorage.getItem("playerId");
      saveState(id);
      doneScreen(false);
      // logEvent("GameDone", [numLvlPassed]);
      // window.location.href = "menu.html";
    }

    function saveState(id) {
      var gameId = sessionStorage.getItem("gameId");

      var gameScore = parseInt(gameLogic.score.toString());
      var sessionScore = sessionStorage.getItem("score") ? parseInt(sessionStorage.getItem("score").toString()) : 0;
      gameScore = gameScore > sessionScore ? gameScore : sessionScore;
      
      sessionStorage.setItem("score", gameScore);
      res = rpc.call("App.updateScore", [id, gameId, gameScore], function() {return;})
    }

    function doneScreen(alldone) {
      // let assignment_id = Args.get_assignment_id();
      // if (assignment_id == "ASSIGNMENT_ID_NOT_AVAILABLE") {
      //     $("#done-screen").html("<h2 class='text-center'><b>You are previewing the HIT. To perform this HIT, please accept it.</b></h2>");
      //     $("#done-screen").fadeIn(1000);
      //     return;
      // }
      // if (assignment_id !== undefined) {
      //     document.getElementById("assignment-id-in-form").value = assignment_id;
      // }
      // let turk_submit_to = Args.get_turk_submit_to();
      // if (turk_submit_to !== undefined) {
      //     document.getElementById("turk-form").action = turk_submit_to + "/mturk/externalSubmit";
      // }
      msg = "Good job! You finished " + numLvlPassed + " level(s)! Your score is: " + gameLogic.score  + "!<br>Click anywhere to continue.";
      if (alldone) {
         msg = "There are no more levels to play at this moment.<br>" + msg
      }
      $("#done-screen").html("<h2 class='good text-center'>" + msg + "</h2>");
      logEvent("GameDone", [numLvlPassed]);
  
      $("#done-screen").fadeIn(1000);
      $("#done-screen").click(function() {
        window.location.replace('menu.html');
      });
    }

    function labelRemover(lbl) {
      return function () { removeLabel(lbl) }
    }

    var tutorialScript = [
      {
        setup: function (cs) {
                  curL = label($('#help_row'), "Help on operators or Replay Tutorials", "left")
                  $('body').focus();
                  cs.nextStepOnKeyClickOrTimeout(stepTimeout, labelRemover(curL), 32);
        }
      },
      { setup: function (cs) {
                   $('#formula-entry').focus();
                   curScript = null;
               }
      },
    ]

    $(document).ready(function() {
      gameId = Args.get_game_id();
      playerId = sessionStorage.getItem("playerId");
      Args.worker_id = playerId;
      Args.hit_id = gameId;

      if(playerId === null) {
        window.location.href = "login.html";
      }

      // var gameURL = window.location.href;

      $("#lblGameId").text(gameId);
      // $("#lblGameURL").text(gameURL);
      $("#lblPlayerId").text(playerId);

      $(window).bind("beforeunload", function() { 
        saveState(playerId);
      })

      var notifyOptions = {
        elementPosition: 'right bottom',
        className: 'success',
      }
      $.notify.defaults(notifyOptions)

      ion.sound({
        sounds: [
          {
            name: "button_tiny"
          },
          {
            name: "glass"
          },
          {
            name: "metal_plate"
          },
          {
            name: "water_droplet_3"
          }
        ],
        volume: 1.0,
        path: "ion.sound-3.0.7/sounds/",
        preload: true
      })
      
      // if (Args.get_assignment_id() == "ASSIGNMENT_ID_NOT_AVAILABLE") {
        // s = "This is just a preview of the HIT. The work you do here will have to be redone when you accept the HIT."
        // $("#hit-preview-warning").html("<p class='lead'><b>" + s + "</b></p>");
      // }

      rpc = new $.JsonRpcClient({ ajaxUrl: "/api" })
      progW = new ProgressWindow($('#discovered-invariants-div'));
      scoreW = new NPlayerScoreWindow($('#score-div'));
      traceW = new PositiveTracesWindow($('#data-display'));
      stickyW = new StickyWindow($('#sticky'))
      gameLogic = new PatternGameLogic(traceW, progW, scoreW, stickyW);

      $('#next-lvl').hide();
      // $('#next-lvl').show();

      gameLogic.onLvlPassed(function() {
        numLvlPassed = numLvlPassed + 1;
        function plural(n,s) { return n == 1? s : s + "s" }
        if (numLvlPassed >= 2) {
          s = "You can continue or quit.";
          // $("#next-or-quit-additional-text").html("<h2>"+s+"</h2>");
          $("#quit-overlay").show();
        } else {
          left = 2 - numLvlPassed;
          s = "Please try to finish at least " + left + plural(left," more level") + "!"
          // $("#next-or-quit-additional-text").html("<h2>"+s+"</h2>")
          $("#quit-overlay").hide();
        }
        $("#next-or-quit-screen").fadeIn(1000);

      });

      $('#next-level-overlay').click(function() {
        $("#next-or-quit-screen").fadeOut(1000);
        nextLvl();
      });

      // $('#next-lvl').click(function() {
      //   // $('#next-lvl').hide();
      //   $('#next-lvl').show();
      //   $('#skip-to-next-lvl').hide();
      //   if (curL)
      //     removeLabel(curL);

      //   nextLvl();
      // })

      $('#help').click(function() {
        $('#help-content').slideToggle(200);
      })

      var openEx = null;
      function _openEx(idn) {
        var el = $('#' + idn)[0]
        if (openEx != null && openEx != el) {
          $(openEx).slideToggle(200, function () {
            $(el).slideToggle(200);
          })
          openEx = el;
        } else if (openEx != null) {
          assert (openEx == el);
          $(openEx).slideToggle(200);
          openEx = null;
        } else {
          assert (openEx == null);
          $(el).slideToggle(200);
          openEx = el;
        }
      }

      var ops = [['#plus_op', 'plus_ex'],
                 ['#minus_op', 'minus_ex'],
                 ['#mul_op', 'mul_ex'],
                 ['#div_op', 'div_ex'],
                 ['#mod_op', 'mod_ex'],
                 ['#eq_op', 'eq_ex'],
                 ['#neq_op', 'neq_ex'],
                 ['#lt_op', 'lt_ex'],
                 ['#lte_op', 'lte_ex'],
                 ['#gt_op', 'gt_ex'],
                 ['#gte_op', 'gte_ex'],
                 ['#not_op', 'not_ex'],
                 ['#and_op', 'and_ex'],
                 ['#or_op', 'or_ex'],
                 ['#impl_op', 'impl_ex'],
                 ['#tutorials', 'tutorials_info'],
                 //['#equiv_op', 'equiv_ex'],
      ]
      for (var i in ops) {
        $(ops[i][0]).click(function (lbl) {
          return function() {_openEx(lbl);}
        }(ops[i][1]))
      }

      $('#see-conditional-tutorial-1, #see-conditional-tutorial-2').click(function() { 
        logEvent("SeeConditionalTutorial", []);
        $('#tutorial-video').fadeIn(1000)
      });
      $('#tutorial-video-done').click(function() { 
        $('#tutorial-video').fadeOut(1000) 
      });
      $('#replay-tutorial-all').click(function() {
        logEvent("ReplayTutorialAll", []);
        window.open('tutorial_patterns.html?tutorialAction=redo-all', '_blank').focus();
      })
      $('#replay-tutorial-cond-1, #replay-tutorial-cond-2').click(function() {
        logEvent("ReplayTutorialConditional", []);
        window.open('tutorial_patterns.html?tutorialAction=redo-cond', '_blank').focus();
      })

      // $('#quit').click(function () { doneScreen(false) });
      $('#quit').click(quit);
      $('#skip-to-next-lvl').click(function () {
        // nextLvl();
        $('#skip-to-next-lvl').hide();
        $('#skip-to-next-lvl').prop("disable", true);
        gameLogic.skipToNextLvl();
      });
      $('#quit-overlay').click(function() { doneScreen(false) });

      $('#arrows').click(function() {
        if (curScript == null && !doneScript) {
          curScript = new Script(tutorialScript);
          doneScript = true;
        }
      })

      if (dynamicLvlOrder)
        nextLvl()
      else
        loadLvlSet("desugared-boogie-benchmarks");

      gameLogic.onLvlLoaded(function () {
        if (!doneScript) {
          curScript = new Script(tutorialScript)
          doneScript = true;
        }
      })

      gameLogic.onUserInput(function () {
        if (curScript) {
          curScript.cancel()
          curScript = null
        }
        if (gameLogic.foundJSInv.length >= numReqExpr) {
          $("#skip-to-next-lvl").show();
          $('#skip-to-next-lvl').prop("disable", false);
        }
        else {
          $("#skip-to-next-lvl").hide();
          $('#skip-to-next-lvl').prop("disable", true);
        }
      })
    })

    setInterval(function () {
        while (!gameId) {}
        synchronize();
      }, time);

  </script>
</head>
<body>
  <div class='container'>
    <div class="row">
      <div class="col-md-3 centered">
        <h3>Player: <label id="lblPlayerId" class="success"></label></h3>
      </div>
      <div class="col-md-6 centered">
        <h2>Multiplayer inv-gen-game</h2>
      </div>
      <div class="col-md-3 centered">
        <h3>Game: <label id="lblGameId" class="success"></label></h3>
      </div>
    </div>
  </div>
  <div class='container'>
    <div class='row' id='hit-preview-warning'>
    </div>
    <div class='row' id='hint-row'>
    </div>
    <div class='row'>
      <div class='col-md-1' id='dummy'>
      </div>
      <div class='col-md-1 box stickyWindow' id='sticky'>
      </div>

      <div class='col-md-6' id='middle'>
        <div class='row' id='data-display' style="font-family:monospace;">
        </div>
        <div class='row box' id='help_row'>
                <span class='centered'> <h4>Click below for Help on Operators or to Replay tutorials:</h4></span>
                <div id='ops'>
                  <table class='opTable'>
                    <tr>
                      <td class="centered"><a id='plus_op'>+</a></td>
                      <td class="centered"><a id='minus_op'>-</a></td>
                      <td class="centered"><a id='mul_op'>*</a></td>
                      <td class="centered"><a id='div_op'>/</a></td>
                      <td class="centered"><a id='mod_op'>%</a></td>
                      <td class="centered"><a id='eq_op'>=</a></td>
                      <td class="centered"><a id='neq_op'>!=</a></td>
                      <td class="centered"><a id='lt_op'>&lt</a></td>
                      <td class="centered"><a id='lte_op'>&lt=</a></td>
                      <td class="centered"><a id='gt_op'>&gt</a></td>
                      <td class="centered"><a id='gte_op'> &gt=</a></td>
                      <td class="centered"><a id='not_op'>!</a></td>
                      <td class="centered"><a id='and_op'>&amp;&amp;</a></td>
                      <td class="centered"><a id='or_op'>||</a></td>
                      <td class="centered"><a id='impl_op'>if</a></td>
                      <td class="centered"><a id='tutorials'>Tutorials</a></td>
<!--
                      <td class="centered"><a id='equiv_op'>&lt=&gt</a></td>
-->
                    </tr>
                  </table>
                      
                <h5>
                <div id="plus_ex" style='display: none'>
                  Addition: X + Y returns the sum of X and Y. <br> Examples:
                    <span class='bold'>3+4</span> ;
                    <span class='bold'>i+1</span> ;
                    <span class='bold'>i=j+1</span>
                </div>
                <div id="minus_ex" style='display: none'>
                  Subtraction: X - Y returns the difference of X and Y. <br> Examples:
                    <span class='bold'>5-4</span> ;
                    <span class='bold'>i-1</span> ;
                    <span class='bold'>i-j=5</span>
                </div>
                <div id="mul_ex" style='display: none'>
                  Multiplication: X * Y returns X and Y. <br> Examples:
                    <span class='bold'>5*4</span> ;
                    <span class='bold'>5*j=20</span> ;
                    <span class='bold'>5*j=20</span>  
                </div>
                <div id="div_ex" style='display: none'>
                  Division: X / Y returns X divived by Y. <br> Examples:
                    <span class='bold'>10/2</span> ;
                    <span class='bold'>i/3</span> ;
                    <span class='bold'>i/2=5</span>
                </div>
                <div id="mod_ex" style='display: none'>
                  Modulo: X % Y  returns the remainder of division of X by Y. <br> Examples:
                    <span class='bold'>5 % 3 = 2</span> ;
                    <span class='bold'>i % 3</span>  
                </div>
                <div id="eq_ex" style='display: none'>
                  Equality: X = Y is true if X is equal to Y. <br> Examples: 
                    <span class='bold'>n = 5</span>; 
                    <span class='bold'>!(5 = 4)</span>; 
                    <span class='bold'>i = a+b</span>  
                </div>
                <div id="neq_ex" style='display: none'>
                  Not-equal: X != Y is true if X is not equal to Y. <br> Examples:
                    <span class='bold'>5 != 4</span> ;
                    <span class='bold'>a != b+c</span>  
                </div>
                <div id="lt_ex" style='display: none'>
                    Less than: X &lt; Y is true if X is less than Y. <br> Examples:
                    <span class='bold'>4 &lt; 5</span> ;
                    <span class='bold'>i &lt; 5</span> ;
                    <span class='bold'>i &lt; j</span>  
                </div>
                <div id="lte_ex" style='display: none'>
                    Less than or equal: X &lt;= Y is true if X is less than or equal to Y. <br> Examples: 
                    <span class='bold'>4 &lt; 5</span>,
                    <span class='bold'>5 &lt; 5</span>,
                    <span class='bold'>i &lt;= 5</span>,
                    <span class='bold'>i &lt;= j</span>
                </div>
                <div id="gt_ex" style='display: none'>
                    Greater than: X &gt; Y is true if X is greater than Y. <br> Examples:
                    <span class='bold'>5 &gt; 4</span>,
                    <span class='bold'>i &gt; 3</span>  
                </div>
                <div id="gte_ex" style='display: none'>
                    Greater than or equal: X &gt;= Y is true if X is greater than or equal to Y. <br>Examples:
                    <span class='bold'>5 &gt;= 4</span>,
                    <span class='bold'>4 &gt;= 4</span>,
                    <span class='bold'>i &gt;= 3</span>  
                </div>
                <div id="not_ex" style='display: none'>
                    Logical Not: !B is true if B is false. <br> Examples:
                    <span class='bold'>!false</span>,
                    <span class='bold'>!(3=4)</span>,
                    <span class='bold'>!(i &gt;= 3)</span>  
                </div>
                <div id="and_ex" style='display: none'>
                    Logical And: A &amp;&amp; B is true if both A and B are true. <br>Examples:
                    <span class='bold'>true &amp;&amp; true</span>,
                    <span class='bold'>(3 &gt; 0) &amp;&amp; (4 &lt;= 5) </span>,
                    <span class='bold'>(i=2) &amp;&amp; (j &gt; 0 )</span>  
                </div>
                <div id="or_ex" style='display: none'>
                    Logical Or: A || B is true if A is true or B is true. <br> Examples:
                    <span class='bold'>true || false</span>,
                    <span class='bold'>(3 &gt; 0) || (4 &lt;= 5) </span>,
                    <span class='bold'>(i=2) || (j &gt; 0)</span>
                </div>
                <div id="impl_ex" style='display: none'>
                    <p>
                    If operator: "A if B" is true if A is true whenever B is true. <br> Examples:
                    <span class='bold'>i=j if i < n</span> ;
                    <span class='bold'>i=k if i >= n</span></p>
                    <button id='see-conditional-tutorial-1'>Video of "if" Tutorial</button>
                    <button id='replay-tutorial-cond-1'>Replay "if" Tutorial</button></p>
                </div>
                <div id="tutorials_info" style='display: none'>
                    <button id='see-conditional-tutorial-2'>Video of "if" Tutorial</button>
                    <button id='replay-tutorial-cond-2'>Replay "if" Tutorial</button>
                    <button id='replay-tutorial-all'>Replay Entire Tutorial</button>
                </div>
                <div id="equiv_ex" style='display: none'>The equivalence operator. Example: i <=> j checks if i is logically equivalent to j</div>
                      
                </h5>
                </div>
        </div>
        <div class='row ' id='quit-div'>
          <button id='quit' class='btn-quit'>Quit</button>
          <button id='skip-to-next-lvl' class='btn-next' style='display: none;'>Next Level</button>
        </div>
        <!--<div class='row-md-6'>
          <div class='col-md-8' id='hint-col'>
            <span id='next_lvl_span'>
              <button id='next-lvl' class='btn-next'>Next Level</button>
            </span>
          </div>
        </div>-->
      </div>

      <div class='col-md-3' >
        <div id='score-div-row' class='row positioned box progressWindow'>
          <div class='col-md-2'>Score: </div>
          <div id='score-div' class='col-md-7 col-md-offset-3'>
          </div>
        </div>
        <div id='scoreboard-div-row' class='row positioned box progressWindow'>
        </div>
        <div class='row good centered positioned' id='discovered-invariants-div'>
        </div>
      </div>
    </div>
  </div>
  <div class='overlay text-center' style='display: none;' id='tutorial-video'>
     <center>
       <video width="75%" controls>
         <source src="https://cseweb.ucsd.edu/~lerner/if-tutorial.mp4" type="video/mp4">
           Your browser does not support the video tag.
       </video>
    </center>
    <button id='tutorial-video-done' class='btn-next'>Return to Game</button>
  </div> 
  <div class='overlay text-center' style='display: none;' id='next-or-quit-screen'>
    <h1 class='good'> Good job, you finished another level!</h1>
    <!--<div id='next-or-quit-additional-text'></div>-->
    <button id='next-level-overlay' class='btn-next'>Next Level</button>
    <button id='quit-overlay' class='btn-next'>Quit</button>
  </div> 
  <div class='overlay' style='display: none;' id='done-screen'>
  </div> 
</body>
</html>
