(flag == 1 ==> i == j) && (flag == 1 ==> n == 1)
